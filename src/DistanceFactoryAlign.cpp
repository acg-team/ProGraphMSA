#include "DistanceFactoryAlign.h"
#include "debug.h"

template <>
void DistanceFactoryAlign<AA>::initMatrix() {
	// BLOSUM64

	static int data[] = {4, 0, -2, -1, -2, 0, -2, -1, -1, -1, -1, -2, -1, -1, -1,
	1, 0, 0, -3, -2, 0, 0, 9, -3, -4, -2, -3, -3, -1, -3, -1, -1, -3, -3, -3, -3,
	-1, -1, -1, -2, -2, -2, -2, -3, 6, 2, -3, -1, -1, -3, -1, -4, -3, 1, -1, 0, -2,
	0, -1, -3, -4, -3, -1, -1, -4, 2, 5, -3, -2, 0, -3, 1, -3, -2, 0, -1, 2, 0, 0,
	-1, -2, -3, -2, -1, -2, -2, -3, -3, 6, -3, -1, 0, -3, 0, 0, -3, -4, -3, -3, -2,
	-2, -1, 1, 3, -1, 0, -3, -1, -2, -3, 6, -2, -4, -2, -4, -3, 0, -2, -2, -2, 0,
	-2, -3, -2, -3, -1, -2, -3, -1, 0, -1, -2, 8, -3, -1, -3, -2, 1, -2, 0, 0, -1,
	-2, -3, -2, 2, -1, -1, -1, -3, -3, 0, -4, -3, 4, -3, 2, 1, -3, -3, -3, -3, -2,
	-1, 3, -3, -1, -1, -1, -3, -1, 1, -3, -2, -1, -3, 5, -2, -1, 0, -1, 1, 2, 0, -1,
	-2, -3, -2, -1, -1, -1, -4, -3, 0, -4, -3, 2, -2, 4, 2, -3, -3, -2, -2, -2, -1,
	1, -2, -1, -1, -1, -1, -3, -2, 0, -3, -2, 1, -1, 2, 5, -2, -2, 0, -1, -1, -1, 1,
	-1, -1, -1, -2, -3, 1, 0, -3, 0, 1, -3, 0, -3, -2, 6, -2, 0, 0, 1, 0, -3, -4,
	-2, -1, -1, -3, -1, -1, -4, -2, -2, -3, -1, -3, -2, -2, 7, -1, -2, -1, -1, -2,
	-4, -3, -2, -1, -3, 0, 2, -3, -2, 0, -3, 1, -2, 0, 0, -1, 5, 1, 0, -1, -2, -2,
	-1, -1, -1, -3, -2, 0, -3, -2, 0, -3, 2, -2, -1, 0, -2, 1, 5, -1, -1, -3, -3,
	-2, -1, 1, -1, 0, 0, -2, 0, -1, -2, 0, -2, -1, 1, -1, 0, -1, 4, 1, -2, -3, -2,
	0, 0, -1, -1, -1, -2, -2, -2, -1, -1, -1, -1, 0, -1, -1, -1, 1, 5, 0, -2, -2, 0,
	0, -1, -3, -2, -1, -3, -3, 3, -2, 1, 1, -3, -2, -2, -3, -2, 0, 4, -3, -1, -1,
	-3, -2, -4, -3, 1, -2, -2, -3, -3, -2, -1, -4, -4, -2, -3, -3, -2, -3, 11, 2,
	-2, -2, -2, -3, -2, 3, -3, 2, -1, -2, -1, -1, -2, -3, -1, -2, -2, -2, -1, 2, 7,
	-1, 0, -2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -2, -1, -1, 0, 0, -1, -2, -1,
	-1};

	this->scoring_matrix = Eigen::Map<Eigen::Matrix<int,AA::DIM+1,AA::DIM+1> >(data);
	this->gap_open = -10;
	this->gap_extend = -2;
}

#ifdef WITH_CODON
template<>
void DistanceFactoryAlign<Codon>::initMatrix() {
	// BLOSUM64 expanded to codon alphabet

	static int data[] = {6, 6, 0, 0, -2, -2, -2, -2, 3, 3, -2, -2, 1, 0, 0,
	0, 0, -4, -4, -4, -4, -1, -1, -3, -3, -3, -3, -3, -3, 0, 0, 0, 0, -2, -2,
	-2, -2, -3, -3, -3, -3, -2, -2, -3, -3, -1, -1, -1, -1, -2, -2, -2, -2, -3,
	-3, -3, -3, -3, -3, -3, -3, -1, 6, 6, 0, 0, -2, -2, -2, -2, 3, 3, -2, -2, 1,
	0, 0, 0, 0, -4, -4, -4, -4, -1, -1, -3, -3, -3, -3, -3, -3, 0, 0, 0, 0, -2,
	-2, -2, -2, -3, -3, -3, -3, -2, -2, -3, -3, -1, -1, -1, -1, -2, -2, -2, -2,
	-3, -3, -3, -3, -3, -3, -3, -3, -1, 0, 0, 4, 4, -2, -2, -2, -2, -1, -1, -1,
	-1, -2, 4, 4, 4, 4, -3, -3, -3, -3, -3, -3, -2, -2, -2, -2, -2, -2, 2, 2, 2,
	2, -1, -1, -1, -1, -3, -3, -2, -2, -2, -2, -2, -2, 1, 1, 1, 1, -1, -1, -1,
	-1, -4, -4, -3, -3, -4, -4, -4, -4, -1, 0, 0, 4, 4, -2, -2, -2, -2, -1, -1,
	-1, -1, -2, 4, 4, 4, 4, -3, -3, -3, -3, -3, -3, -2, -2, -2, -2, -2, -2, 2,
	2, 2, 2, -1, -1, -1, -1, -3, -3, -2, -2, -2, -2, -2, -2, 1, 1, 1, 1, -1, -1,
	-1, -1, -4, -4, -3, -3, -4, -4, -4, -4, -1, -2, -2, -2, -2, 4, 4, 4, 4, -2,
	-2, -1, -1, -3, -2, -2, -2, -2, -1, -1, -1, -1, -1, -1, 0, 0, -1, -1, -1,
	-1, -2, -2, -2, -1, 1, 1, 1, 1, 1, 1, 0, 0, 4, 4, -1, -1, -2, -2, -2, -2, 1,
	1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2, -2, 4, 4, 4, 4, -2, -2, -1,
	-1, -3, -2, -2, -2, -2, -1, -1, -1, -1, -1, -1, 0, 0, -1, -1, -1, -1, -2,
	-2, -2, -1, 1, 1, 1, 1, 1, 1, 0, 0, 4, 4, -1, -1, -2, -2, -2, -2, 1, 1, 1,
	1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2, -2, 4, 4, 4, 4, -2, -2, -1, -1,
	-3, -2, -2, -2, -2, -1, -1, -1, -1, -1, -1, 0, 0, -1, -1, -1, -1, -2, -2,
	-2, -1, 1, 1, 1, 1, 1, 1, 0, 0, 4, 4, -1, -1, -2, -2, -2, -2, 1, 1, 1, 1, 0,
	0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2, -2, 4, 4, 4, 4, -2, -2, -1, -1, -3, -2,
	-2, -2, -2, -1, -1, -1, -1, -1, -1, 0, 0, -1, -1, -1, -1, -2, -2, -2, -1, 1,
	1, 1, 1, 1, 1, 0, 0, 4, 4, -1, -1, -2, -2, -2, -2, 1, 1, 1, 1, 0, 0, 0, 0,
	0, 0, 0, 0, 0, 3, 3, -1, -1, -2, -2, -2, -2, 7, 7, -2, -2, 2, -1, -1, -1,
	-1, -3, -3, -3, -3, 2, 2, -1, -1, -2, -2, -2, -2, -1, -1, -1, -1, -2, -2,
	-2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -1, -1, -1, -1, -2, -2, -2, -2, -3,
	-3, -2, -2, -3, -3, -3, -3, -1, 3, 3, -1, -1, -2, -2, -2, -2, 7, 7, -2, -2,
	2, -1, -1, -1, -1, -3, -3, -3, -3, 2, 2, -1, -1, -2, -2, -2, -2, -1, -1, -1,
	-1, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -1, -1, -1, -1, -2, -2,
	-2, -2, -3, -3, -2, -2, -3, -3, -3, -3, -1, -2, -2, -1, -1, -1, -1, -1, -1,
	-2, -2, 9, 9, -2, -1, -1, -1, -1, -3, -3, -3, -3, -3, -3, -3, -3, -3, -3,
	-3, -3, -1, -1, -1, -1, -1, -1, -1, -1, -3, -3, -3, -3, -1, -1, -3, -3, -1,
	-1, -1, -1, 0, 0, 0, 0, -3, -3, -4, -4, -3, -3, -3, -3, -2, -2, -2, -1, -1,
	-1, -1, -1, -1, -2, -2, 9, 9, -2, -1, -1, -1, -1, -3, -3, -3, -3, -3, -3,
	-3, -3, -3, -3, -3, -3, -1, -1, -1, -1, -1, -1, -1, -1, -3, -3, -3, -3, -1,
	-1, -3, -3, -1, -1, -1, -1, 0, 0, 0, 0, -3, -3, -4, -4, -3, -3, -3, -3, -2,
	1, 1, -2, -2, -3, -3, -3, -3, 2, 2, -2, -2, 11, -2, -2, -2, -2, -4, -4, -4,
	-4, -2, -2, -2, -2, -3, -3, -3, -3, -3, -3, -3, -1, -2, -2, -2, -2, -4, -4,
	-3, -3, -3, -3, -3, -3, -3, -3, -3, -3, -3, -3, -3, -3, -4, -4, -3, -3, -2,
	-2, -2, -2, -2, 0, 0, 4, 4, -2, -2, -2, -2, -1, -1, -1, -1, -2, 4, 4, 4, 4,
	-3, -3, -3, -3, -3, -3, -2, -2, -2, -2, -2, -2, 2, 2, 2, 2, -1, -1, -1, -1,
	-3, -3, -2, -2, -2, -2, -2, -2, 1, 1, 1, 1, -1, -1, -1, -1, -4, -4, -3, -3,
	-4, -4, -4, -4, -1, 0, 0, 4, 4, -2, -2, -2, -2, -1, -1, -1, -1, -2, 4, 4, 4,
	4, -3, -3, -3, -3, -3, -3, -2, -2, -2, -2, -2, -2, 2, 2, 2, 2, -1, -1, -1,
	-1, -3, -3, -2, -2, -2, -2, -2, -2, 1, 1, 1, 1, -1, -1, -1, -1, -4, -4, -3,
	-3, -4, -4, -4, -4, -1, 0, 0, 4, 4, -2, -2, -2, -2, -1, -1, -1, -1, -2, 4,
	4, 4, 4, -3, -3, -3, -3, -3, -3, -2, -2, -2, -2, -2, -2, 2, 2, 2, 2, -1, -1,
	-1, -1, -3, -3, -2, -2, -2, -2, -2, -2, 1, 1, 1, 1, -1, -1, -1, -1, -4, -4,
	-3, -3, -4, -4, -4, -4, -1, 0, 0, 4, 4, -2, -2, -2, -2, -1, -1, -1, -1, -2,
	4, 4, 4, 4, -3, -3, -3, -3, -3, -3, -2, -2, -2, -2, -2, -2, 2, 2, 2, 2, -1,
	-1, -1, -1, -3, -3, -2, -2, -2, -2, -2, -2, 1, 1, 1, 1, -1, -1, -1, -1, -4,
	-4, -3, -3, -4, -4, -4, -4, -1, -4, -4, -3, -3, -1, -1, -1, -1, -3, -3, -3,
	-3, -4, -3, -3, -3, -3, 7, 7, 7, 7, -2, -2, -1, -1, -2, -2, -2, -2, -3, -3,
	-3, -2, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1, -2, -2, -2, -2, -2, -2, -1,
	-1, -1, -1, -1, -1, -1, -1, -2, -2, -2, -2, -2, -4, -4, -3, -3, -1, -1, -1,
	-1, -3, -3, -3, -3, -4, -3, -3, -3, -3, 7, 7, 7, 7, -2, -2, -1, -1, -2, -2,
	-2, -2, -3, -3, -3, -2, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1, -2, -2, -2,
	-2, -2, -2, -1, -1, -1, -1, -1, -1, -1, -1, -2, -2, -2, -2, -2, -4, -4, -3,
	-3, -1, -1, -1, -1, -3, -3, -3, -3, -4, -3, -3, -3, -3, 7, 7, 7, 7, -2, -2,
	-1, -1, -2, -2, -2, -2, -3, -3, -3, -2, -1, -1, -1, -1, -2, -2, -1, -1, -1,
	-1, -2, -2, -2, -2, -2, -2, -1, -1, -1, -1, -1, -1, -1, -1, -2, -2, -2, -2,
	-2, -4, -4, -3, -3, -1, -1, -1, -1, -3, -3, -3, -3, -4, -3, -3, -3, -3, 7,
	7, 7, 7, -2, -2, -1, -1, -2, -2, -2, -2, -3, -3, -3, -2, -1, -1, -1, -1, -2,
	-2, -1, -1, -1, -1, -2, -2, -2, -2, -2, -2, -1, -1, -1, -1, -1, -1, -1, -1,
	-2, -2, -2, -2, -2, -1, -1, -3, -3, -1, -1, -1, -1, 2, 2, -3, -3, -2, -3,
	-3, -3, -3, -2, -2, -2, -2, 8, 8, 0, 0, 0, 0, 0, 0, -3, -3, -3, -2, -2, -2,
	-2, -2, 1, 1, -1, -1, -1, -1, 0, 0, -3, -3, -3, -3, -2, -2, -2, -2, -1, -1,
	0, 0, -2, -2, -2, -2, -1, -1, -1, -3, -3, -1, -1, -1, -1, 2, 2, -3, -3, -2,
	-3, -3, -3, -3, -2, -2, -2, -2, 8, 8, 0, 0, 0, 0, 0, 0, -3, -3, -3, -2, -2,
	-2, -2, -2, 1, 1, -1, -1, -1, -1, 0, 0, -3, -3, -3, -3, -2, -2, -2, -2, -1,
	-1, 0, 0, -2, -2, -2, -2, -1, -3, -3, -2, -2, 0, 0, 0, 0, -1, -1, -3, -3,
	-2, -2, -2, -2, -2, -1, -1, -1, -1, 0, 0, 5, 5, 1, 1, 1, 1, -3, -3, -3, 0,
	-1, -1, -1, -1, 0, 0, 1, 1, 0, 0, 1, 1, -2, -2, -2, -2, -1, -1, -1, -1, 0,
	0, 2, 2, -2, -2, -2, -2, -1, -3, -3, -2, -2, 0, 0, 0, 0, -1, -1, -3, -3, -2,
	-2, -2, -2, -2, -1, -1, -1, -1, 0, 0, 5, 5, 1, 1, 1, 1, -3, -3, -3, 0, -1,
	-1, -1, -1, 0, 0, 1, 1, 0, 0, 1, 1, -2, -2, -2, -2, -1, -1, -1, -1, 0, 0, 2,
	2, -2, -2, -2, -2, -1, -3, -3, -2, -2, -1, -1, -1, -1, -2, -2, -3, -3, -3,
	-2, -2, -2, -2, -2, -2, -2, -2, 0, 0, 1, 1, 5, 5, 5, 5, -3, -3, -3, -1, -1,
	-1, -1, -1, 0, 0, 2, 2, -1, -1, 5, 5, -3, -3, -3, -3, -1, -1, -1, -1, -2,
	-2, 0, 0, -2, -2, -2, -2, -1, -3, -3, -2, -2, -1, -1, -1, -1, -2, -2, -3,
	-3, -3, -2, -2, -2, -2, -2, -2, -2, -2, 0, 0, 1, 1, 5, 5, 5, 5, -3, -3, -3,
	-1, -1, -1, -1, -1, 0, 0, 2, 2, -1, -1, 5, 5, -3, -3, -3, -3, -1, -1, -1,
	-1, -2, -2, 0, 0, -2, -2, -2, -2, -1, -3, -3, -2, -2, -1, -1, -1, -1, -2,
	-2, -3, -3, -3, -2, -2, -2, -2, -2, -2, -2, -2, 0, 0, 1, 1, 5, 5, 5, 5, -3,
	-3, -3, -1, -1, -1, -1, -1, 0, 0, 2, 2, -1, -1, 5, 5, -3, -3, -3, -3, -1,
	-1, -1, -1, -2, -2, 0, 0, -2, -2, -2, -2, -1, -3, -3, -2, -2, -1, -1, -1,
	-1, -2, -2, -3, -3, -3, -2, -2, -2, -2, -2, -2, -2, -2, 0, 0, 1, 1, 5, 5, 5,
	5, -3, -3, -3, -1, -1, -1, -1, -1, 0, 0, 2, 2, -1, -1, 5, 5, -3, -3, -3, -3,
	-1, -1, -1, -1, -2, -2, 0, 0, -2, -2, -2, -2, -1, 0, 0, 2, 2, -2, -2, -2,
	-2, -1, -1, -1, -1, -3, 2, 2, 2, 2, -3, -3, -3, -3, -3, -3, -3, -3, -3, -3,
	-3, -3, 4, 4, 4, 1, -1, -1, -1, -1, -3, -3, -3, -3, -2, -2, -3, -3, 3, 3, 3,
	3, -1, -1, -1, -1, -3, -3, -3, -3, -4, -4, -4, -4, -1, 0, 0, 2, 2, -2, -2,
	-2, -2, -1, -1, -1, -1, -3, 2, 2, 2, 2, -3, -3, -3, -3, -3, -3, -3, -3, -3,
	-3, -3, -3, 4, 4, 4, 1, -1, -1, -1, -1, -3, -3, -3, -3, -2, -2, -3, -3, 3,
	3, 3, 3, -1, -1, -1, -1, -3, -3, -3, -3, -4, -4, -4, -4, -1, 0, 0, 2, 2, -2,
	-2, -2, -2, -1, -1, -1, -1, -3, 2, 2, 2, 2, -3, -3, -3, -3, -3, -3, -3, -3,
	-3, -3, -3, -3, 4, 4, 4, 1, -1, -1, -1, -1, -3, -3, -3, -3, -2, -2, -3, -3,
	3, 3, 3, 3, -1, -1, -1, -1, -3, -3, -3, -3, -4, -4, -4, -4, -1, 0, 0, 2, 2,
	-1, -1, -1, -1, -1, -1, -1, -1, -1, 2, 2, 2, 2, -2, -2, -2, -2, -2, -2, 0,
	0, -1, -1, -1, -1, 1, 1, 1, 5, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1, -1,
	-1, 1, 1, 1, 1, -1, -1, -1, -1, -3, -3, -2, -2, -3, -3, -3, -3, -1, -2, -2,
	-1, -1, 1, 1, 1, 1, -2, -2, -1, -1, -2, -1, -1, -1, -1, -1, -1, -1, -1, -2,
	-2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 5, 5, 5, 5, 0, 0, -1, -1, 1, 1,
	-1, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, -2, -2, -2, -2, 0, -2, -2,
	-1, -1, 1, 1, 1, 1, -2, -2, -1, -1, -2, -1, -1, -1, -1, -1, -1, -1, -1, -2,
	-2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 5, 5, 5, 5, 0, 0, -1, -1, 1, 1,
	-1, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, -2, -2, -2, -2, 0, -2, -2,
	-1, -1, 1, 1, 1, 1, -2, -2, -1, -1, -2, -1, -1, -1, -1, -1, -1, -1, -1, -2,
	-2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 5, 5, 5, 5, 0, 0, -1, -1, 1, 1,
	-1, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, -2, -2, -2, -2, 0, -2, -2,
	-1, -1, 1, 1, 1, 1, -2, -2, -1, -1, -2, -1, -1, -1, -1, -1, -1, -1, -1, -2,
	-2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 5, 5, 5, 5, 0, 0, -1, -1, 1, 1,
	-1, -1, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, -2, -2, -2, -2, 0, -3, -3,
	-3, -3, 1, 1, 1, 1, -2, -2, -3, -3, -4, -3, -3, -3, -3, -2, -2, -2, -2, 1,
	1, 0, 0, 0, 0, 0, 0, -3, -3, -3, -2, 0, 0, 0, 0, 6, 6, 0, 0, 1, 1, 0, 0, -3,
	-3, -3, -3, -2, -2, -2, -2, 1, 1, 0, 0, 0, 0, 0, 0, -1, -3, -3, -3, -3, 1,
	1, 1, 1, -2, -2, -3, -3, -4, -3, -3, -3, -3, -2, -2, -2, -2, 1, 1, 0, 0, 0,
	0, 0, 0, -3, -3, -3, -2, 0, 0, 0, 0, 6, 6, 0, 0, 1, 1, 0, 0, -3, -3, -3, -3,
	-2, -2, -2, -2, 1, 1, 0, 0, 0, 0, 0, 0, -1, -3, -3, -2, -2, 0, 0, 0, 0, -2,
	-2, -3, -3, -3, -2, -2, -2, -2, -1, -1, -1, -1, -1, -1, 1, 1, 2, 2, 2, 2,
	-3, -3, -3, -1, -1, -1, -1, -1, 0, 0, 5, 5, 0, 0, 2, 2, -2, -2, -2, -2, -1,
	-1, -1, -1, -1, -1, 1, 1, -2, -2, -2, -2, -1, -3, -3, -2, -2, 0, 0, 0, 0,
	-2, -2, -3, -3, -3, -2, -2, -2, -2, -1, -1, -1, -1, -1, -1, 1, 1, 2, 2, 2,
	2, -3, -3, -3, -1, -1, -1, -1, -1, 0, 0, 5, 5, 0, 0, 2, 2, -2, -2, -2, -2,
	-1, -1, -1, -1, -1, -1, 1, 1, -2, -2, -2, -2, -1, -2, -2, -2, -2, 4, 4, 4,
	4, -2, -2, -1, -1, -3, -2, -2, -2, -2, -1, -1, -1, -1, -1, -1, 0, 0, -1, -1,
	-1, -1, -2, -2, -2, -1, 1, 1, 1, 1, 1, 1, 0, 0, 4, 4, -1, -1, -2, -2, -2,
	-2, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2, -2, 4, 4, 4, 4, -2,
	-2, -1, -1, -3, -2, -2, -2, -2, -1, -1, -1, -1, -1, -1, 0, 0, -1, -1, -1,
	-1, -2, -2, -2, -1, 1, 1, 1, 1, 1, 1, 0, 0, 4, 4, -1, -1, -2, -2, -2, -2, 1,
	1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -3, -3, -2, -2, -1, -1, -1, -1, -2, -2,
	-3, -3, -3, -2, -2, -2, -2, -2, -2, -2, -2, 0, 0, 1, 1, 5, 5, 5, 5, -3, -3,
	-3, -1, -1, -1, -1, -1, 0, 0, 2, 2, -1, -1, 5, 5, -3, -3, -3, -3, -1, -1,
	-1, -1, -2, -2, 0, 0, -2, -2, -2, -2, -1, -3, -3, -2, -2, -1, -1, -1, -1,
	-2, -2, -3, -3, -3, -2, -2, -2, -2, -2, -2, -2, -2, 0, 0, 1, 1, 5, 5, 5, 5,
	-3, -3, -3, -1, -1, -1, -1, -1, 0, 0, 2, 2, -1, -1, 5, 5, -3, -3, -3, -3,
	-1, -1, -1, -1, -2, -2, 0, 0, -2, -2, -2, -2, -1, -1, -1, 1, 1, -2, -2, -2,
	-2, -1, -1, -1, -1, -3, 1, 1, 1, 1, -2, -2, -2, -2, -3, -3, -2, -2, -3, -3,
	-3, -3, 3, 3, 3, 1, 0, 0, 0, 0, -3, -3, -2, -2, -2, -2, -3, -3, 4, 4, 4, 4,
	0, 0, 0, 0, -3, -3, -2, -2, -3, -3, -3, -3, -1, -1, -1, 1, 1, -2, -2, -2,
	-2, -1, -1, -1, -1, -3, 1, 1, 1, 1, -2, -2, -2, -2, -3, -3, -2, -2, -3, -3,
	-3, -3, 3, 3, 3, 1, 0, 0, 0, 0, -3, -3, -2, -2, -2, -2, -3, -3, 4, 4, 4, 4,
	0, 0, 0, 0, -3, -3, -2, -2, -3, -3, -3, -3, -1, -1, -1, 1, 1, -2, -2, -2,
	-2, -1, -1, -1, -1, -3, 1, 1, 1, 1, -2, -2, -2, -2, -3, -3, -2, -2, -3, -3,
	-3, -3, 3, 3, 3, 1, 0, 0, 0, 0, -3, -3, -2, -2, -2, -2, -3, -3, 4, 4, 4, 4,
	0, 0, 0, 0, -3, -3, -2, -2, -3, -3, -3, -3, -1, -1, -1, 1, 1, -2, -2, -2,
	-2, -1, -1, -1, -1, -3, 1, 1, 1, 1, -2, -2, -2, -2, -3, -3, -2, -2, -3, -3,
	-3, -3, 3, 3, 3, 1, 0, 0, 0, 0, -3, -3, -2, -2, -2, -2, -3, -3, 4, 4, 4, 4,
	0, 0, 0, 0, -3, -3, -2, -2, -3, -3, -3, -3, -1, -2, -2, -1, -1, 1, 1, 1, 1,
	-2, -2, 0, 0, -3, -1, -1, -1, -1, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, 0, 0, 0, 0, -2, -2, -1, -1, 1, 1, -1, -1, 0, 0, 0,
	0, 4, 4, 4, 4, -2, -2, -1, -1, 0, 0, 0, 0, 0, -2, -2, -1, -1, 1, 1, 1, 1,
	-2, -2, 0, 0, -3, -1, -1, -1, -1, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, 0, 0, 0, 0, -2, -2, -1, -1, 1, 1, -1, -1, 0, 0, 0,
	0, 4, 4, 4, 4, -2, -2, -1, -1, 0, 0, 0, 0, 0, -2, -2, -1, -1, 1, 1, 1, 1,
	-2, -2, 0, 0, -3, -1, -1, -1, -1, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, 0, 0, 0, 0, -2, -2, -1, -1, 1, 1, -1, -1, 0, 0, 0,
	0, 4, 4, 4, 4, -2, -2, -1, -1, 0, 0, 0, 0, 0, -2, -2, -1, -1, 1, 1, 1, 1,
	-2, -2, 0, 0, -3, -1, -1, -1, -1, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1,
	-1, -1, -1, -1, -1, -1, 0, 0, 0, 0, -2, -2, -1, -1, 1, 1, -1, -1, 0, 0, 0,
	0, 4, 4, 4, 4, -2, -2, -1, -1, 0, 0, 0, 0, 0, -3, -3, -4, -4, 0, 0, 0, 0,
	-3, -3, -3, -3, -4, -4, -4, -4, -4, -1, -1, -1, -1, -1, -1, 0, 0, -2, -2,
	-2, -2, -3, -3, -3, -3, -1, -1, -1, -1, 1, 1, -1, -1, 0, 0, -2, -2, -3, -3,
	-3, -3, -2, -2, -2, -2, 6, 6, 2, 2, -1, -1, -1, -1, -1, -3, -3, -4, -4, 0,
	0, 0, 0, -3, -3, -3, -3, -4, -4, -4, -4, -4, -1, -1, -1, -1, -1, -1, 0, 0,
	-2, -2, -2, -2, -3, -3, -3, -3, -1, -1, -1, -1, 1, 1, -1, -1, 0, 0, -2, -2,
	-3, -3, -3, -3, -2, -2, -2, -2, 6, 6, 2, 2, -1, -1, -1, -1, -1, -3, -3, -3,
	-3, 0, 0, 0, 0, -2, -2, -4, -4, -3, -3, -3, -3, -3, -1, -1, -1, -1, 0, 0, 2,
	2, 0, 0, 0, 0, -3, -3, -3, -2, -1, -1, -1, -1, 0, 0, 1, 1, 0, 0, 0, 0, -2,
	-2, -2, -2, -1, -1, -1, -1, 2, 2, 5, 5, -2, -2, -2, -2, -1, -3, -3, -3, -3,
	0, 0, 0, 0, -2, -2, -4, -4, -3, -3, -3, -3, -3, -1, -1, -1, -1, 0, 0, 2, 2,
	0, 0, 0, 0, -3, -3, -3, -2, -1, -1, -1, -1, 0, 0, 1, 1, 0, 0, 0, 0, -2, -2,
	-2, -2, -1, -1, -1, -1, 2, 2, 5, 5, -2, -2, -2, -2, -1, -3, -3, -4, -4, 0,
	0, 0, 0, -3, -3, -3, -3, -2, -4, -4, -4, -4, -2, -2, -2, -2, -2, -2, -2, -2,
	-2, -2, -2, -2, -4, -4, -4, -3, -2, -2, -2, -2, 0, 0, -2, -2, 0, 0, -2, -2,
	-3, -3, -3, -3, 0, 0, 0, 0, -1, -1, -2, -2, 6, 6, 6, 6, -1, -3, -3, -4, -4,
	0, 0, 0, 0, -3, -3, -3, -3, -2, -4, -4, -4, -4, -2, -2, -2, -2, -2, -2, -2,
	-2, -2, -2, -2, -2, -4, -4, -4, -3, -2, -2, -2, -2, 0, 0, -2, -2, 0, 0, -2,
	-2, -3, -3, -3, -3, 0, 0, 0, 0, -1, -1, -2, -2, 6, 6, 6, 6, -1, -3, -3, -4,
	-4, 0, 0, 0, 0, -3, -3, -3, -3, -2, -4, -4, -4, -4, -2, -2, -2, -2, -2, -2,
	-2, -2, -2, -2, -2, -2, -4, -4, -4, -3, -2, -2, -2, -2, 0, 0, -2, -2, 0, 0,
	-2, -2, -3, -3, -3, -3, 0, 0, 0, 0, -1, -1, -2, -2, 6, 6, 6, 6, -1, -3, -3,
	-4, -4, 0, 0, 0, 0, -3, -3, -3, -3, -2, -4, -4, -4, -4, -2, -2, -2, -2, -2,
	-2, -2, -2, -2, -2, -2, -2, -4, -4, -4, -3, -2, -2, -2, -2, 0, 0, -2, -2, 0,
	0, -2, -2, -3, -3, -3, -3, 0, 0, 0, 0, -1, -1, -2, -2, 6, 6, 6, 6, -1, -1,
	-1, -1, -1, 0, 0, 0, 0, -1, -1, -2, -2, -2, -1, -1, -1, -1, -2, -2, -2, -2,
	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1,
	0, 0, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, -1,
	-1};

	this->scoring_matrix = Eigen::Map<Eigen::Matrix<int,Codon::DIM+1,Codon::DIM+1> >(data);
	this->gap_open = -10;
	this->gap_extend = -2;
}
#endif

#ifdef WITH_DNA
template <>
void DistanceFactoryAlign<DNA>::initMatrix() {
	// FIXME only very simple model for DNA alignment

	this->scoring_matrix << 1, -1, -2, -2, 0, -1, 1, -2, -2, 0, -2, -2, 1, -1, 0,
	-2, -2, -1, 1, 0, 0, 0, 0, 0, 0;

	this->gap_open = -5;
	this->gap_extend = -2;
}
#endif
